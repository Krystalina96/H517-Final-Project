<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <link rel="stylesheet" href="style.css">

    <title>Project 2: Nolasco</title>
  </head>
  <body>
    <!-- Side navigation -->
    <div class="sidenav">
        <a href="visualization.html">Visualization</a>
        <a href="about.html">About</a>
        <a href="video.html">Video</a>
    </div>

    <!-- Page content -->
    <div class="main">
        <div class="header">COVID-19</div>
        <div id="sub-title">a visualization by Krystal Nolasco</div>

        <div class="grid-container">
            <div class="item1">
                <div id="map">
                    <p class="sub-header">Map of Outbreak</p>
                    <p class="information-text" id="map-information-text">Hover over points on the map for additional information.</p>
                    <svg id="map-grid"></svg>
                </div>

                <div id="timeline">
                    <p class="sub-header">Timeline of Deaths Per Day</p>
                    <p class="information-text">Hover over bars on the chart to visualize deaths by date on the map.</p>
                    <svg id="timeline-grid"></svg>
                </div>
            </div>

            <div class="item2">
                <p class="sub-sub-header">Deaths by Gender</p>
                <svg id="gender-graph-grid"></svg>
            </div>

            <div class="item3">
                <p class="sub-sub-header">Deaths by Age Group</p>
                <svg id="age-graph-grid"></svg>
            </div>
        </div>

        <div class="footer">&copy; Copyright 2022 Krystal Nolasco</div>
    </div>
  </body>
  <script>
      
        var mapMargin = {top: 0, right: 20, bottom: 20, left: 20},
            mapWidth = 960 - mapMargin.left - mapMargin.right,
            mapHeight = 500 - mapMargin.top - mapMargin.bottom; 

        var projection = d3.geo.albersUsa()
            .translate([mapWidth/2, mapHeight/2])
            .scale([1000]);

        var path = d3.geo.path()
            .projection(projection); 

        var color = d3.scale.linear()
            .range(["rgb(213,222,217)","rgb(69,173,168)","rgb(84,36,55)","rgb(217,91,67)"]);

        //create SVG area 
        var svg_map = d3.select("#map-grid")
            .attr("width", mapWidth + mapMargin.left + mapMargin.right)
            .attr("height", mapHeight + mapMargin.top + mapMargin.bottom)
            .style('border', 'solid');

        //load in data 
        d3.csv('data/United_States_COVID-19_Community_Levels_by_County_as_Originally_Posted.csv', function (data) {
            //console.log(data);

            var totalAlabama = 0,
                totalAlaska = 0; 
            
            for (i = 0; i < 300; i++) {
                if (data[i].state == "Alabama") {
                    totalAlabama = totalAlabama + Number(data[i].covid_cases_per_100k);  
                } else if (data[i].state == "Alaska") {
                    totalAlaska = totalAlaska + Number(data[i].covid_cases_per_100k);  
                }
            };

            //console.log(totalAlabama);
            //console.log(totalAlaska);

            var stateData = [
                {state: "Alabama", value: totalAlabama},
                {state: "Alaska", value: totalAlaska},
                {state: "Arizona", value: 0}
            ]; 

            //console.log(stateData);

            d3.json("data/us-states.json", function (json) {
                //console.log(json);
                console.log(stateData.length);

                //loop through each state data value in the .csv file 
                for (i = 0; i < stateData.length; i++) {
                    //grab state name 
                    var dataState = stateData[i].state;

                    //grab number of covid cases 
                    var dataValue = stateData[i].value;

                    //find the matching state in the json file 
                    for (j = 0; j < json.features.length; j++) {
                        var jsonState = json.features[j].properties.name; 

                        if (dataState == jsonState) {
                            //copy the data value into the json 
                            json.features[j].properties.cases = dataValue; 
                            break;
                        }
                    }
                }

                //make paths 
                svg_map.selectAll("path")
                    .data(json.features)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke", "black")
                    .style("stroke-width", "1")
                    .style("fill", "white");
                
            })
        })
        

        
  </script>

  